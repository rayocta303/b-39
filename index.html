<!DOCTYPE html>
<html lang="en" class="light">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lampubiled.id</title>
    <!-- Favicons -->
    <link href="assets/icons/favicon.ico" rel="icon" />
    <link href="assets/icons/apple-touch-icon.png" rel="apple-touch-icon" />

    <!-- PWA  -->
    <link rel="manifest" href="manifest.json" />
    <meta name="theme-color" content="#4f46e5" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />

    <!-- Tailwind CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
    <!-- Tailwind Config -->
    <script>
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            colors: {
              primary: "#1e40af", // Indigo
              accent: "#f59e0b", // Amber
            },
          },
        },
      };
    </script>
    <link rel="stylesheet" href="styles.css" />
  </head>

  <body
    class="bg-white text-gray-900 dark:bg-gray-900 dark:text-gray-100 transition-colors duration-300 font-sans"
  >
    <!-- Loading Screen -->
    <div
      id="loadingScreen"
      class="fixed inset-0 z-[9999] flex items-center justify-center bg-white dark:bg-gray-900 transition-opacity duration-500 opacity-100"
    >
      <div class="text-center space-y-4">
        <div
          class="w-10 h-10 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin mx-auto"
        ></div>
        <p class="text-sm text-gray-700 dark:text-gray-200">
          Memuat aplikasi...
        </p>
      </div>
    </div>
    <!-- Mobile Bottom Toolbar -->

    <div
      id="mobileToolbar"
      class="fixed bottom-0 left-0 right-0 z-50 bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 shadow flex justify-around items-center py-2 sm:hidden"
    >
      <!-- Navigasi Item -->
      <button
        id="mobileNavAnimasi"
        class="flex flex-col items-center justify-center w-16 h-14 text-gray-600 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400 transition"
      >
        <i class="fas fa-video text-xl mb-1"></i>
        <span class="text-xs leading-none">Animasi</span>
      </button>

      <button
        id="mobileNavServo"
        class="flex flex-col items-center justify-center w-16 h-14 text-gray-600 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400 transition"
      >
        <i class="fas fa-gear text-xl mb-1"></i>
        <span class="text-xs leading-none">Servo</span>
      </button>

      <a
        id="mobileNavKontak"
        href="#"
        target="_blank"
        class="hidden flex flex-col items-center justify-center w-16 h-14 text-gray-600 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400 transition"
      >
        <i class="fas fa-phone text-xl mb-1"></i>
        <span class="text-xs leading-none">Kontak</span>
      </a>

      <button
        id="mobileNavDebug"
        class="flex flex-col items-center justify-center w-16 h-14 text-gray-600 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400 transition"
      >
        <i class="fas fa-bug text-xl mb-1"></i>
        <span class="text-xs leading-none">Debug</span>
      </button>

      <button
        id="bottomThemeToggle"
        class="flex flex-col items-center justify-center w-16 h-14 text-gray-600 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400 transition"
      >
        <i id="bottomThemeIcon" class="fas fa-moon text-xl mb-1"></i>
        <span class="text-xs leading-none">Theme</span>
      </button>
    </div>
    <!-- FAB Group -->
    <div
      id="fabGroup"
      class="fixed hidden bottom-4 md:block right-4 z-50 flex flex-col items-end gap-3"
    >
      <!-- FAB WhatsApp -->
      <a
        href="https://wa.me/6281234567890"
        target="_blank"
        rel="noopener"
        id="fabWhatsapp"
        class="hidden shadow-lg rounded-full w-12 h-12 flex items-center justify-center bg-green-500 hover:bg-green-600 text-white text-2xl transition mb-2"
        aria-label="WhatsApp"
      >
        <!-- WhatsApp SVG Icon -->
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="currentColor"
          viewBox="0 0 448 512"
          class="w-6 h-6"
        >
          <path
            d="M380.9 97.1C339 55.1 283.6 32 224.1 32 103.6 32 5.5 139.7 0 256c0 48.1 13.5 94.2 38.8 134.5L0 480l93.6-37.7c37.1 20.3 78.9 31.1 121.2 31 120.6 0 218.7-107.7 224.2-224.1 3-59.5-20.6-115-58.1-152.1zM224.1 438c-36.5 0-72.4-9.9-103.5-28.6l-7.4-4.4-55.5 22.3 21.1-57.2-4.8-7.5C54.5 335.1 44 296.6 44 256c5-97.1 86.5-172 180.1-172 46.9 0 90.9 18.3 123.7 51.4 33 33.3 50.4 77.9 47.9 125.2-4.7 87.5-79.1 177.4-171.6 177.4zm101.6-138.4c-5.6-2.8-33.1-16.3-38.3-18.2-5.2-1.9-9-2.8-12.8 2.8s-14.6 18.2-17.9 22c-3.3 3.8-6.6 4.2-12.2 1.4s-23.9-8.8-45.5-28c-16.8-15-28.1-33.5-31.4-39s-.4-8.7 2.5-11.5c2.6-2.6 5.8-6.6 8.7-9.9 2.9-3.3 3.8-5.7 5.7-9.5s.9-7.1-.5-9.9c-1.4-2.8-12.8-30.8-17.6-42.2-4.6-11-9.2-9.5-12.8-9.6-3.3-.1-7.1-.1-10.8-.1s-10 1.4-15.2 7c-5.2 5.7-20 19.5-20 47.5s20.5 55.2 23.4 59c2.9 3.8 40.4 61.7 98.1 86.5 13.7 5.9 24.3 9.4 32.7 12 13.8 4.4 26.3 3.8 36.2 2.3 11.1-1.6 33.1-13.5 37.8-26.5 4.7-13 4.7-24.1 3.3-26.5-1.3-2.4-5.1-3.8-10.7-6.5z"
          />
        </svg>
      </a>

      <!-- FAB Install App -->
      <button
        id="installAppBtn"
        class="hidden shadow-lg rounded-full w-12 h-12 flex items-center justify-center bg-indigo-600 hover:bg-indigo-700 text-white text-xl transition mb-2"
        aria-label="Install App"
      >
        <i class="fas fa-download"></i>
      </button>

      <!-- FAB Debug -->
      <button
        id="fabDebug"
        class="hidden shadow-lg rounded-full w-12 h-12 flex items-center justify-center bg-gray-600 dark:bg-gray-500 hover:bg-gray-700 dark:hover:bg-gray-400 text-white text-xl transition mb-2"
        aria-label="Toggle Debug"
      >
        <i class="fas fa-bug"></i>
      </button>

      <!-- FAB Theme Mode -->
      <button
        id="fabThemeMode"
        class="hidden shadow-lg rounded-full w-12 h-12 flex items-center justify-center bg-gray-300 dark:bg-gray-700 hover:bg-gray-400 dark:hover:bg-gray-600 text-gray-800 dark:text-white text-xl transition mb-2"
        aria-label="Toggle Theme"
      >
        <i id="themeIcon" class="fas fa-moon"></i>
      </button>

      <!-- FAB Main Toggle -->
      <button
        id="fabToggle"
        class="shadow-lg rounded-full w-12 h-12 flex items-center justify-center bg-indigo-600 hover:bg-indigo-700 text-white text-2xl transition"
        aria-label="FAB Menu"
      >
        <i id="fabIcon" class="fas fa-bars"></i>
      </button>
    </div>
    <!-- Main BLE + Controls Panel -->

    <main class="px-4 pb-10 mb-12 max-w-screen-md mx-auto space-y-6">
      <!-- Logo -->
      <section
        id="containerLogo"
        class="bg-gray-100 dark:bg-gray-800 rounded-xl shadow-md space-y-6 mt-6 sm:static sticky top-0 z-40 sm:z-auto transition-all duration-300"
      >
        <div
          id="logoWrapper"
          class="flex items-center justify-center p-3 transition-all duration-300"
        >
          <img
            id="vendorLogo"
            src="assets/logo/logo-light.png"
            alt="Logo"
            class="lg:w-60 w-60 transition-all duration-300"
          />
          <div
            id="logoStatusDot"
            class="hidden w-3 h-3 rounded-full bg-green-500 shadow ml-3 animate-pulse"
          ></div>
        </div>
      </section>

      <section
        id="uploader"
        class="bg-gray-100 dark:bg-gray-800 p-8 rounded-xl shadow-md space-y-6 mt-6 hidden"
      >
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-start">
          <!-- KIRI (Preview IMG) -->
          <div id="gifPreviewWrapper" class="text-center space-y-4">
            <div
              id="gifPreviewBox"
              class="w-80 h-80 md:w-60 md:h-60 bg-gray-200 dark:bg-gray-700 rounded-full md:rounded-lg overflow-hidden shadow mx-auto transition"
            >
              <img
                id="gifPreviewImage"
                src=""
                alt="Preview Animasi"
                class="w-full h-full object-cover"
              />
            </div>
          </div>

          <!-- KANAN (Control) -->
          <div class="space-y-5">
            <!-- Judul Animasi -->
            <div
              class="text-sm text-gray-800 dark:text-white border border-gray-300 dark:border-gray-600 rounded-lg overflow-hidden"
            >
              <div class="grid grid-cols-3 bg-gray-50 dark:bg-gray-800">
                <div
                  class="px-4 py-2 font-semibold bg-gray-100 dark:bg-gray-700 border-r border-gray-300 dark:border-gray-600 text-center"
                >
                  SELECTED
                </div>
                <div
                  id="selectedAnimationTitle"
                  class="col-span-2 px-4 py-2 uppercase text-center overflow-hidden whitespace-nowrap relative"
                >
                  <span class="inline-block">Belum dipilih</span>
                </div>
              </div>
            </div>

            <!-- Tombol Galeri -->
            <button
              id="openGalleryBtn"
              class="w-full bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition"
            >
              Pilih dari Galeri
            </button>

            <!-- Pilih Sisi Upload -->
            <div>
              <div
                class="flex rounded-lg overflow-hidden border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 shadow-sm text-sm font-medium"
              >
                <!-- KIRI -->
                <label class="flex-1 cursor-pointer">
                  <input
                    type="radio"
                    name="uploadSide"
                    value="LEFT"
                    checked
                    class="hidden peer"
                  />
                  <span
                    class="block text-center px-6 py-2 text-gray-800 dark:text-white peer-checked:bg-indigo-600 peer-checked:text-white transition"
                  >
                    Kiri
                  </span>
                </label>
                <!-- KANAN -->
                <label class="flex-1 cursor-pointer">
                  <input
                    type="radio"
                    name="uploadSide"
                    value="RIGHT"
                    class="hidden peer"
                  />
                  <span
                    class="block text-center px-6 py-2 text-gray-800 dark:text-white peer-checked:bg-indigo-600 peer-checked:text-white transition"
                  >
                    Kanan
                  </span>
                </label>
              </div>
            </div>

            <!-- Tombol Upload -->
            <button
              id="uploadSelectedHeaderBtn"
              class="w-full bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-2 rounded-lg font-medium transition"
            >
              Upload
            </button>

            <!-- Progress -->
            <div class="space-y-2 mt-2">
              <div
                id="uploadProgressBar"
                class="relative w-full h-4 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden shadow-inner"
              >
                <div
                  id="uploadProgressFill"
                  class="absolute left-0 top-0 h-full bg-gradient-to-r from-indigo-500 via-purple-500 to-indigo-600 transition-all duration-300 ease-out"
                  style="width: 0%"
                ></div>
              </div>
              <p
                id="uploadProgressText"
                class="text-sm font-medium text-center text-indigo-600 dark:text-indigo-300"
              ></p>
              <div
                id="uploadProgressDetails"
                class="text-xs text-center text-gray-600 dark:text-gray-400 space-y-1 hidden"
              >
                <p>Total Size: <span id="uploadTotalSize">0 bytes</span></p>
                <p>Progress: <span id="uploadCurrentProgress">0 bytes</span> / <span id="uploadTotalProgress">0 bytes</span></p>
                <p>Chunks: <span id="uploadCurrentChunk">0</span> / <span id="uploadTotalChunks">0</span></p>
              </div>
            </div>
          </div>
        </div>

        <!-- Hidden textarea untuk header -->
        <textarea id="uploadHeaderContentLeft" class="hidden"></textarea>
        <textarea id="uploadHeaderContentRight" class="hidden"></textarea>
      </section>

      <!-- Debug Info Card -->
      <section
        id="debugInfo"
        class="bg-gray-100 dark:bg-gray-800 rounded-xl shadow-md"
      >
        <div class="flex justify-between items-center p-4 border-b border-gray-200 dark:border-gray-700">
          <h2 class="text-lg font-bold text-gray-800 dark:text-white flex items-center">
            <i class="fas fa-bug mr-2"></i>
            Debug Information
          </h2>
          <button
            id="toggleDebugBtn"
            class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded text-sm transition flex items-center"
          >
            <i id="debugToggleIcon" class="fas fa-chevron-down mr-1"></i>
            <span id="debugToggleText">Show Debug</span>
          </button>
        </div>

        <div id="debugContent" class="p-4 space-y-4 hidden">
          <!-- Device Information -->
          <div>
            <h3 class="font-semibold text-gray-700 dark:text-gray-300 mb-2 flex items-center">
              <i class="fas fa-microchip mr-2"></i>
              Device Information
            </h3>
            <div class="bg-white dark:bg-gray-700 p-3 rounded border text-sm space-y-2">
              <div class="grid grid-cols-1 md:grid-cols-2 gap-2">
                <div>
                  <span class="font-medium text-gray-600 dark:text-gray-400">Serial Number:</span>
                  <span id="deviceSerial" class="ml-2 text-gray-800 dark:text-white">Not connected</span>
                </div>
                <div>
                  <span class="font-medium text-gray-600 dark:text-gray-400">License Type:</span>
                  <span id="deviceLicense" class="ml-2 text-gray-800 dark:text-white">Unknown</span>
                </div>
                <div>
                  <span class="font-medium text-gray-600 dark:text-gray-400">License Name:</span>
                  <span id="deviceLicenseName" class="ml-2 text-gray-800 dark:text-white">-</span>
                </div>
                <div>
                  <span class="font-medium text-gray-600 dark:text-gray-400">Vendor Code:</span>
                  <span id="deviceVendor" class="ml-2 text-gray-800 dark:text-white">Not detected</span>
                </div>
                <div>
                  <span class="font-medium text-gray-600 dark:text-gray-400">Vendor Name:</span>
                  <span id="deviceVendorName" class="ml-2 text-gray-800 dark:text-white">-</span>
                </div>
                <div>
                  <span class="font-medium text-gray-600 dark:text-gray-400">Connection Status:</span>
                  <span id="deviceConnection" class="ml-2 text-red-500">Disconnected</span>
                </div>
                <div>
                  <span class="font-medium text-gray-600 dark:text-gray-400">Device Type:</span>
                  <span id="deviceType" class="ml-2 text-gray-800 dark:text-white">Unknown</span>
                </div>
                <div>
                  <span class="font-medium text-gray-600 dark:text-gray-400">Firmware Version:</span>
                  <span id="deviceFirmware" class="ml-2 text-gray-800 dark:text-white">-</span>
                </div>
                <div>
                  <span class="font-medium text-gray-600 dark:text-gray-400">Last Response:</span>
                  <span id="deviceLastResponse" class="ml-2 text-gray-800 dark:text-white font-mono text-xs">-</span>
                </div>
                <div>
                  <span class="font-medium text-gray-600 dark:text-gray-400">Response Time:</span>
                  <span id="deviceResponseTime" class="ml-2 text-gray-800 dark:text-white">-</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Gallery Context -->
          <div>
            <h3 class="font-semibold text-gray-700 dark:text-gray-300 mb-2 flex items-center">
              <i class="fas fa-filter mr-2"></i>
              Gallery Context
            </h3>
            <div class="bg-white dark:bg-gray-700 p-3 rounded border text-sm space-y-2">
              <div class="grid grid-cols-1 md:grid-cols-2 gap-2">
                <div>
                  <span class="font-medium text-gray-600 dark:text-gray-400">User Serial:</span>
                  <span id="contextSerial" class="ml-2 text-gray-800 dark:text-white">-</span>
                </div>
                <div>
                  <span class="font-medium text-gray-600 dark:text-gray-400">User Vendor:</span>
                  <span id="contextVendor" class="ml-2 text-gray-800 dark:text-white">-</span>
                </div>
                <div>
                  <span class="font-medium text-gray-600 dark:text-gray-400">User License:</span>
                  <span id="contextLicense" class="ml-2 text-gray-800 dark:text-white">-</span>
                </div>
                <div>
                  <span class="font-medium text-gray-600 dark:text-gray-400">Filter Category:</span>
                  <span id="contextCategory" class="ml-2 text-gray-800 dark:text-white">All</span>
                </div>
                <div>
                  <span class="font-medium text-gray-600 dark:text-gray-400">Total Items:</span>
                  <span id="contextTotal" class="ml-2 text-gray-800 dark:text-white">0</span>
                </div>
                <div>
                  <span class="font-medium text-gray-600 dark:text-gray-400">Filtered Items:</span>
                  <span id="contextFiltered" class="ml-2 text-gray-800 dark:text-white">0</span>
                </div>
              </div>
            </div>
          </div>

          <!-- File Information -->
          <div>
            <h3 class="font-semibold text-gray-700 dark:text-gray-300 mb-2 flex items-center">
              <i class="fas fa-file mr-2"></i>
              File Information
            </h3>
            <div
              id="fileInfo"
              class="bg-white dark:bg-gray-700 p-3 rounded border text-sm"
            >
              <p class="text-gray-600 dark:text-gray-400">
                No file selected
              </p>
            </div>
          </div>

          <!-- Selected Data -->
          <div>
            <h3 class="font-semibold text-gray-700 dark:text-gray-300 mb-2 flex items-center">
              <i class="fas fa-database mr-2"></i>
              Selected Data
            </h3>
            <div
              id="selectedData"
              class="bg-white dark:bg-gray-700 p-3 rounded border text-sm"
            >
              <p class="text-gray-600 dark:text-gray-400">
                No data selected
              </p>
            </div>
          </div>

          <!-- GIF Preview -->
          <div>
            <h3 class="font-semibold text-gray-700 dark:text-gray-300 mb-2 flex items-center">
              <i class="fas fa-image mr-2"></i>
              GIF Preview
            </h3>
            <div
              id="gifPreview"
              class="bg-white dark:bg-gray-700 p-3 rounded border text-center"
            >
              <p class="text-gray-600 dark:text-gray-400 text-sm">
                No GIF selected
              </p>
            </div>
          </div>

          <!-- Debug Configuration -->
          <div>
            <h3 class="font-semibold text-gray-700 dark:text-gray-300 mb-2 flex items-center">
              <i class="fas fa-cog mr-2"></i>
              Debug Configuration
            </h3>
            <div class="bg-white dark:bg-gray-700 p-3 rounded border text-sm space-y-3">
              <!-- Environment Selection -->
              <div>
                <label class="block font-medium text-gray-600 dark:text-gray-400 mb-1">
                  API Environment:
                </label>
                <select id="apiEnvironmentSelect" class="w-full p-2 border rounded dark:bg-gray-600 dark:border-gray-500 dark:text-white">
                  <option value="development">Development (JSON)</option>
                  <option value="production">Production (PHP)</option>
                </select>
              </div>
              
              <!-- Debug Options -->
              <div class="space-y-2">
                <label class="flex items-center">
                  <input type="checkbox" id="debugEnabledCheck" class="mr-2">
                  <span class="text-gray-700 dark:text-gray-300">Enable Debug Mode</span>
                </label>
                <label class="flex items-center">
                  <input type="checkbox" id="debugCardCheck" class="mr-2">
                  <span class="text-gray-700 dark:text-gray-300">Show Debug Card</span>
                </label>
                <label class="flex items-center">
                  <input type="checkbox" id="cacheEnabledCheck" class="mr-2" checked>
                  <span class="text-gray-700 dark:text-gray-300">Enable Caching</span>
                </label>
              </div>
              
              <!-- Actions -->
              <div class="flex gap-2 pt-2">
                <button id="clearCacheBtn" class="px-3 py-1 bg-red-500 text-white rounded text-xs hover:bg-red-600">
                  Clear Cache
                </button>
                <button id="reloadGalleryBtn" class="px-3 py-1 bg-blue-500 text-white rounded text-xs hover:bg-blue-600">
                  Reload Gallery
                </button>
              </div>
            </div>
          </div>

          <!-- Debug Card -->
          <div id="debugCard" class="hidden bg-yellow-50 dark:bg-yellow-900 border border-yellow-200 dark:border-yellow-700 rounded p-3 text-xs">
            <div class="debug-header">
              <h4 class="font-semibold text-yellow-800 dark:text-yellow-200">Debug Info</h4>
            </div>
            <div class="debug-content text-yellow-700 dark:text-yellow-300">
              Debug card is ready...
            </div>
          </div>
        </div>
      </section>

      <!-- Kontrol Servo -->
      <section
        id="servoSetting"
        class="bg-gray-100 dark:bg-gray-800 p-8 rounded-xl shadow-md hidden"
      >
        <h2 class="text-lg font-bold text-gray-800 dark:text-white mb-4">
          Pengaturan Servo
        </h2>

        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4">
          <!-- Min -->
          <div>
            <label
              for="servoMin"
              class="block text-sm font-medium text-gray-700 dark:text-gray-300 pb-2"
            >
              Sudut Tutup
            </label>
            <input
              type="number"
              id="servoMin"
              value="30"
              min="0"
              max="180"
              class="w-full rounded px-3 py-2 border dark:border-gray-600 dark:bg-gray-700 dark:text-white"
            />
          </div>

          <!-- Max -->
          <div>
            <label
              for="servoMax"
              class="block text-sm font-medium text-gray-700 dark:text-gray-300 pb-2"
            >
              Sudut Buka
            </label>
            <input
              type="number"
              id="servoMax"
              value="90"
              min="0"
              max="180"
              class="w-full rounded px-3 py-2 border dark:border-gray-600 dark:bg-gray-700 dark:text-white"
            />
          </div>
        </div>

        <!-- Tombol Kirim -->
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
          <button
            id="servoKiriBtn"
            class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded transition w-full"
          >
            Kirim Servo Kiri
          </button>

          <button
            id="servoKananBtn"
            class="bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded transition w-full"
          >
            Kirim Servo Kanan
          </button>
        </div>
      </section>

      <!-- BLE Panel -->
      <section
        id="blePanel"
        class="bg-gray-100 dark:bg-gray-800 p-6 rounded-xl shadow-md"
      >
        <!-- Serial Number + Lisensi -->
        <div
          id="formLisensi"
          class="grid grid-cols-1 sm:grid-cols-3 gap-4 items-end hidden"
        >
          <!-- Kode Lisensi + Tombol -->
          <!-- Serial Number -->
          <div class="sm:col-span-3">
            <label
              for="SN"
              class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
            >
              Serial Number
            </label>

            <div class="flex gap-3">
              <input
                id="SN"
                readonly
                class="flex-1 px-3 py-2 rounded border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm"
              />
              <button
                id="copySNBtn"
                type="button"
                class="px-4 py-2 text-sm bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-white rounded hover:bg-gray-300 dark:hover:bg-gray-500 transition"
              >
                Salin
              </button>
            </div>
          </div>

          <div class="lisensi sm:col-span-3">
            <label
              for="lisensi"
              class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
            >
              Kode Lisensi
            </label>
            <div class="flex flex-col sm:flex-row gap-2">
              <input
                id="liseensi"
                placeholder="Masukkan kode lisensi"
                class="w-full sm:flex-1 px-3 py-2 rounded border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm"
              />
              <button
                id="submitLisensiBtn"
                class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded text-sm w-full sm:w-auto"
              >
                Aktivasi
              </button>
              <button
                id="resetLisensiBtn"
                class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded text-sm w-full sm:w-auto"
              >
                Reset Lisensi
              </button>
            </div>
          </div>
        </div>

        <!-- BLE Status -->
        <div
          class="flex flex-col sm:flex-row sm:items-center justify-between gap-4 pb-2"
        >
          <!-- Kiri (Status) -->
          <div class="flex-1 text-center sm:text-left">
            <h2 class="text-lg font-bold text-gray-900 dark:text-white">
              Status Koneksi
            </h2>
            <div
              id="bleStatusWrapper"
              class="flex items-center justify-center sm:justify-start gap-2 text-sm text-gray-600 dark:text-gray-300 mt-1"
            >
              <span
                id="bleDot"
                class="inline-block w-2 h-2 rounded-full bg-red-500 animate-pulse"
              ></span>
              <span id="bleStatusText">Belum terhubung</span>
            </div>
          </div>

          <!-- Kanan (Button) -->
          <div class="sm:w-auto w-full">
            <button
              id="connectBtn"
              class="w-full sm:w-auto bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded text-sm transition"
            >
              Hubungkan Bluetooth
            </button>
          </div>
        </div>

        <!-- Log Area -->
        <div>
          <div
            id="bleLog"
            class="bg-white dark:bg-gray-900 border dark:border-gray-700 p-3 rounded h-40 overflow-y-auto text-xs font-mono text-gray-700 dark:text-gray-300 scroll-smooth"
          >
            <p>[Hey!] Selamat datang di Lampubiled.id</p>
            <p>
              [Info] Silakan hubungkan perangkat via Bluetooth terlebih dahulu.
            </p>
          </div>
        </div>
      </section>
      <section
        id="panduan"
        class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-5 border border-gray-200 dark:border-gray-700 hidden"
      >
        <h2 class="text-lg font-semibold text-gray-800 dark:text-white mb-3">
Panduan Aktivasi Lisensi
        </h2>
        <ul
          class="list-decimal list-inside space-y-2 text-sm text-gray-700 dark:text-gray-300"
        >
          <li>Pastikan perangkat BLE telah terhubung.</li>
          <li>Cek bahwa Serial Number (SN) telah muncul otomatis.</li>
          <li>Masukkan kode lisensi sesuai paket yang Anda miliki.</li>
          <li>
            Tekan tombol <span class="font-medium">Aktivasi</span> untuk
            mengirim kode ke perangkat.
          </li>
          <li>
            Jika berhasil, form aktivasi akan otomatis disembunyikan dan lisensi
            akan aktif.
          </li>
          <li>
            Jika gagal, pastikan kode lisensi benar dan perangkat BLE tidak
            terputus.
          </li>
        </ul>
      </section>
      <!-- iOS Hint -->
      <div
        id="iosHint"
        class="hidden mx-auto max-w-md text-sm text-center mt-6 px-4 py-3 bg-red-100 text-yellow-800 border border-red-300 rounded-lg shadow"
      >
        <strong>Perhatian Pengguna iPhone/iPad:</strong><br />
        Apps Biled tidak tersedia di iOS/Safari karena keterbatasan sistem.
      </div>

      <!-- PWA Installation Card -->
      <section
        id="pwaInstallCard"
        class="bg-gradient-to-r from-indigo-500 to-purple-600 text-white rounded-xl shadow-lg p-6 mt-8 hidden"
      >
        <div class="flex items-center justify-between">
          <div class="flex-1">
            <h3 class="text-lg font-bold mb-2 flex items-center">
              <i class="fas fa-mobile-alt mr-2"></i>
              Install Lampubiled App
            </h3>
            <p class="text-sm opacity-90 mb-4">
              Install aplikasi ini di perangkat Android Anda untuk pengalaman yang lebih baik dan akses offline.
            </p>
            <div class="flex flex-col sm:flex-row gap-3">
              <button
                id="mobileInstallBtn"
                class="bg-white text-indigo-600 hover:bg-gray-100 px-4 py-2 rounded-lg text-sm font-medium transition flex items-center justify-center"
              >
                <i class="fas fa-download mr-2"></i>
                Install Sekarang
              </button>
              <button
                id="dismissInstallCard"
                class="bg-transparent border border-white/30 hover:bg-white/10 px-4 py-2 rounded-lg text-sm font-medium transition"
              >
                Nanti Saja
              </button>
            </div>
          </div>
          <div class="ml-4 hidden sm:block">
            <i class="fas fa-download text-3xl opacity-50"></i>
          </div>
        </div>
      </section>
    </main>

    <!-- Modal Galeri -->
    <div
      id="galleryModal"
      class="fixed inset-0 flex items-center justify-center p-4 backdrop-blur-sm bg-black/50 z-50 hidden"
    >
      <div
        class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 w-full max-w-3xl max-h-[90vh] overflow-y-auto"
      >
        <div class="flex justify-between items-center mb-4">
          <h2 class="text-lg font-bold text-gray-800 dark:text-white">
            Galeri Animasi
          </h2>
          <button
            id="closeGalleryBtn"
            class="text-sm font-medium text-gray-600 hover:text-gray-800 dark:text-gray-400 dark:hover:text-white px-3 py-1 rounded transition"
          >
            Tutup
          </button>
        </div>

        <!-- Filter kategori -->
        <div class="mb-4">
          <select
            id="categoryFilter"
            class="w-full px-3 py-2 rounded border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-sm text-gray-800 dark:text-white"
          >
            <option value="all">Semua Kategori</option>
            <!-- Categories will be populated here -->
          </select>
        </div>

        <!-- Galeri Container -->
        <div class="relative mt-4">
          <!-- Grid galeri -->
          <div id="galleryContainer">
            <div
              id="galleryList"
              class="grid grid-cols-2 sm:grid-cols-4 gap-4"
            ></div>
          </div>
        </div>

        <!-- Gallery End -->
      </div>
    </div>

    <!-- Toast Container -->
    <div
      id="toastContainer"
      class="fixed inset-x-0 z-50 flex flex-col-reverse items-center gap-2 pointer-events-none bottom-[4.5rem] sm:bottom-8"
    >
      <!-- Toasts -->
    </div>
    <!-- Global Modal -->
    <div
      id="globalModal"
      class="fixed h-100 p-4 inset-0 backdrop-blur-sm bg-black/50 z-50 flex items-center justify-center hidden"
    >
      <div
        class="bg-white dark:bg-gray-800 rounded-lg p-6 w-full sm:max-w-sm md:max-w-md lg:max-w-lg xl:max-w-xl shadow-lg relative text-center"
      >
        <div id="modalIcon" class="text-4xl mb-3"></div>
        <h3
          id="modalTitle"
          class="text-lg font-semibold text-gray-800 dark:text-white mb-2"
        ></h3>
        <p
          id="modalMessage"
          class="text-sm text-gray-600 dark:text-gray-300 mb-4"
        ></p>
        <button
          id="modalCloseBtn"
          class="w-full px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded text-sm"
        >
          OK
        </button>
      </div>
    </div>
    <script type="module" src="main.js"></script>
  </body>
</html>